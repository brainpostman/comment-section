const form=document.getElementById("comment-form"),commentSection=document.querySelector(".comments__section");let commentCount=0,commentId=0,commentCounter=document.getElementById("count"),imgNotLikeSrc="./img/not-like.svg",imgLikeSrc="./img/like.svg";function submitOnEnter(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),e.target.closest("#comment-form").dispatchEvent(new Event("submit")))}function validateForm(t){t.preventDefault();var t=t.target,e=(t.sender.value=t.sender.value.trim(),t.text.value=t.text.value.trim(),t.sender.checkValidity()),r=t.text.checkValidity(),n=t.date.checkValidity();if(e&&n&&r){let e;e=""===t.date.value?t.date.max:t.date.value,submitComment({sender:t.sender.value,text:t.text.value,date:e})}}function checkDateInput(){var e=document.createElement("input"),t=(e.setAttribute("type","date"),"not-a-date");return e.setAttribute("value",t),e.value!==t}function displayErrorMessage(e,t){document.querySelector(".error__"+t).innerHTML=e}function submitComment({sender:e,text:t,date:r}){commentCount++,commentCounter.textContent=commentCount;var n=document.querySelector(".comments__section"),a=document.createElement("li"),e=(a.className="comments__comment",a.id="comment-"+commentId++,a.dataset.like="0",a.insertAdjacentHTML("afterbegin",` <div class="comment" tabindex="-1">
                            <div class="comment__info">
                            <div class="comment__sender"></div>
                            <div class="comment__datetime"></div></div>
                            <div class="comment__text"></div></div><div class="comment__options">
                            <div class="comment__like"><img src="./img/not-like.svg" alt="Мне нравится" title="Мне нравится"></div>
                            <div class="comment__delete"><img src="./img/trash.svg" alt="Удалить комментарий" title="Удалить комментарий"></div></div>`),a.querySelector(".comment__sender").textContent=e,a.querySelector(".comment__text").textContent=t,buildDateObj(r.split("-")));a.querySelector(".comment__datetime").textContent=e.date,a.dataset.date=e.dateStr,a.dataset.time=e.timeStr,n.prepend(a)}function buildDateObj([e,t,r]){var n=Date.parse(e+`-${t}-`+r),a=Date.parse(form.date.max),o=a-864e5,m=(new Date).toLocaleTimeString().slice(0,5),r=r+`.${t}.`+e,t={timeStr:m,dateStr:r};return t.date=n===a?"сегодня, "+m:n===o?"вчера, "+m:r+", "+m,t}form.date.max=(new Date).toLocaleDateString("fr-ca"),form.addEventListener("keydown",submitOnEnter),form.addEventListener("submit",validateForm),form.sender.oninvalid=e=>{e=e.target.value;0===e.length?displayErrorMessage("Имя не может быть пустым или<br> состоять только из пробелов","sender"):e.length<6||30<e.length?displayErrorMessage("Имя должно иметь длину от 6 до 30 символов","sender"):/^[a-zA-Zа-яА-Я0-9\-_ ]{6,30}$/g.test(e)||displayErrorMessage("Имя может содержать:<br>- русский и латинский алфавит<br>- цифры (0 - 9)<br>- дефис и нижнее подчеркивание","sender")},form.date.oninvalid=e=>{if(!checkDateInput()){var t=new Date;if(dateStr=e.target.value.trim(),!(regex=/^(0[1-9]|[12][0-9]|3[01])[-](0[1-9]|1[012])[-](19|20)\d\d$/g).test(dateStr))return void displayErrorMessage("Дата должна быть в формате:<br>дд-мм-гггг","date");var[e,r,n]=dateStr.split("-"),e=+e;if(r-=1,(n=+n)<1970||n>t.getFullYear())return void displayErrorMessage("Год должен быть между 1970 и "+t.getFullYear(),"date");if(new Date(n,1+r,0).getDate()<e)return void displayErrorMessage("Введена некорректная дата","date")}displayErrorMessage("Введена некорректная дата","date")},form.text.oninvalid=e=>{0===e.target.value.length&&displayErrorMessage("Комментарий не может быть пустым или состоять только из пробелов","text")},form.sender.oninput=()=>{document.querySelector(".error__sender").innerHTML=""},form.sender.onfocus=e=>{e.target.placeholder=""},form.sender.onblur=e=>{""===e.target.value&&(e.target.placeholder="Ваше имя")},form.text.oninput=e=>{document.querySelector(".error__text").innerHTML="",e.target.placeholder=""},form.text.onfocus=e=>{e.target.placeholder=""},form.text.onblur=e=>{""===e.target.value&&(e.target.placeholder="Ваш комментарий...")},form.date.onkeydown=()=>{checkDateInput()&&(document.querySelector(".error__date").innerHTML="")},form.date.oninput=()=>{checkDateInput()||(document.querySelector(".error__date").innerHTML="")},form.date.onfocus=e=>{e.target.placeholder=""},form.date.onblur=e=>{""!==e.target.value||checkDateInput()||(e.target.placeholder="дд-мм-гггг")},commentSection.onclick=e=>{var e=e.target,t=e.closest(".comments__comment")??null;e.closest(".comment__delete")&&t&&(t.remove(),commentCount--,commentCounter.textContent=commentCount),e.closest(".comment__like")&&t&&("0"===t.dataset.like?(t.dataset.like="1",e.src=imgLikeSrc,e.title="Мне не нравится",e.alt="Мне не нравится"):(t.dataset.like="0",e.src=imgNotLikeSrc,e.title="Мне нравится",e.alt="Мне нравится"))};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibWFpbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnQtZm9ybScpO1xyXG5cclxuY29uc3QgY29tbWVudFNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWVudHNfX3NlY3Rpb24nKTtcclxuXHJcbmxldCBjb21tZW50Q291bnQgPSAwO1xyXG5sZXQgY29tbWVudElkID0gMDtcclxuXHJcbmxldCBjb21tZW50Q291bnRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudCcpO1xyXG5cclxubGV0IGltZ05vdExpa2VTcmMgPSAnLi9pbWcvbm90LWxpa2Uuc3ZnJztcclxubGV0IGltZ0xpa2VTcmMgPSAnLi9pbWcvbGlrZS5zdmcnO1xyXG5cclxuZm9ybS5kYXRlLm1heCA9IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCdmci1jYScpO1xyXG5cclxuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgc3VibWl0T25FbnRlcik7XHJcbmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdmFsaWRhdGVGb3JtKTtcclxuXHJcbmZvcm0uc2VuZGVyLm9uaW52YWxpZCA9IChldmVudCkgPT4ge1xyXG4gICAgbGV0IHNlbmRlciA9IGV2ZW50LnRhcmdldC52YWx1ZTtcclxuICAgIGlmIChzZW5kZXIubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgZGlzcGxheUVycm9yTWVzc2FnZShcItCY0LzRjyDQvdC1INC80L7QttC10YIg0LHRi9GC0Ywg0L/Rg9GB0YLRi9C8INC40LvQuDxicj4g0YHQvtGB0YLQvtGP0YLRjCDRgtC+0LvRjNC60L4g0LjQtyDQv9GA0L7QsdC10LvQvtCyXCIsIFwic2VuZGVyXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChzZW5kZXIubGVuZ3RoIDwgNiB8fCBzZW5kZXIubGVuZ3RoID4gMzApIHtcclxuICAgICAgICBkaXNwbGF5RXJyb3JNZXNzYWdlKFwi0JjQvNGPINC00L7Qu9C20L3QviDQuNC80LXRgtGMINC00LvQuNC90YMg0L7RgiA2INC00L4gMzAg0YHQuNC80LLQvtC70L7QslwiLCBcInNlbmRlclwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgcmVnZXggPSAvXlthLXpBLVrQsC3Rj9CQLdCvMC05XFwtXyBdezYsMzB9JC9nO1xyXG4gICAgaWYgKCFyZWdleC50ZXN0KHNlbmRlcikpIHtcclxuICAgICAgICBkaXNwbGF5RXJyb3JNZXNzYWdlKFwi0JjQvNGPINC80L7QttC10YIg0YHQvtC00LXRgNC20LDRgtGMOjxicj4tINGA0YPRgdGB0LrQuNC5INC4INC70LDRgtC40L3RgdC60LjQuSDQsNC70YTQsNCy0LjRgjxicj4tINGG0LjRhNGA0YsgKDAgLSA5KTxicj4tINC00LXRhNC40YEg0Lgg0L3QuNC20L3QtdC1INC/0L7QtNGH0LXRgNC60LjQstCw0L3QuNC1XCIsIFwic2VuZGVyXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxufTtcclxuXHJcbmZvcm0uZGF0ZS5vbmludmFsaWQgPSAoZXZlbnQpID0+IHtcclxuICAgIGlmICghY2hlY2tEYXRlSW5wdXQoKSkge1xyXG4gICAgICAgIGxldCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgZGF0ZVN0ciA9IGV2ZW50LnRhcmdldC52YWx1ZS50cmltKCk7XHJcbiAgICAgICAgcmVnZXggPSAvXigwWzEtOV18WzEyXVswLTldfDNbMDFdKVstXSgwWzEtOV18MVswMTJdKVstXSgxOXwyMClcXGRcXGQkL2c7XHJcbiAgICAgICAgaWYgKCFyZWdleC50ZXN0KGRhdGVTdHIpKSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlFcnJvck1lc3NhZ2UoXCLQlNCw0YLQsCDQtNC+0LvQttC90LAg0LHRi9GC0Ywg0LIg0YTQvtGA0LzQsNGC0LU6PGJyPtC00LQt0LzQvC3Qs9Cz0LPQs1wiLCBcImRhdGVcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IFtkYXRlRGF5LCBkYXRlTW9udGgsIGRhdGVZZWFyXSA9IGRhdGVTdHIuc3BsaXQoXCItXCIpO1xyXG4gICAgICAgIGRhdGVEYXkgPSArZGF0ZURheTtcclxuICAgICAgICBkYXRlTW9udGggPSBkYXRlTW9udGggLSAxO1xyXG4gICAgICAgIGRhdGVZZWFyID0gK2RhdGVZZWFyO1xyXG4gICAgICAgIGlmIChkYXRlWWVhciA8IDE5NzAgfHwgZGF0ZVllYXIgPiBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpKSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlFcnJvck1lc3NhZ2UoYNCT0L7QtCDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LzQtdC20LTRgyAxOTcwINC4ICR7Y3VycmVudERhdGUuZ2V0RnVsbFllYXIoKX1gLCBcImRhdGVcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGRhdGVMYXN0RGF5ID0gbmV3IERhdGUoZGF0ZVllYXIsIGRhdGVNb250aCArIDEsIDApLmdldERhdGUoKTtcclxuICAgICAgICBpZiAoZGF0ZURheSA+IGRhdGVMYXN0RGF5KSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlFcnJvck1lc3NhZ2UoJ9CS0LLQtdC00LXQvdCwINC90LXQutC+0YDRgNC10LrRgtC90LDRjyDQtNCw0YLQsCcsIFwiZGF0ZVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGRpc3BsYXlFcnJvck1lc3NhZ2UoJ9CS0LLQtdC00LXQvdCwINC90LXQutC+0YDRgNC10LrRgtC90LDRjyDQtNCw0YLQsCcsIFwiZGF0ZVwiKTtcclxufVxyXG5cclxuZm9ybS50ZXh0Lm9uaW52YWxpZCA9IChldmVudCkgPT4ge1xyXG4gICAgbGV0IHRleHQgPSBldmVudC50YXJnZXQudmFsdWU7XHJcbiAgICBpZiAodGV4dC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBkaXNwbGF5RXJyb3JNZXNzYWdlKFwi0JrQvtC80LzQtdC90YLQsNGA0LjQuSDQvdC1INC80L7QttC10YIg0LHRi9GC0Ywg0L/Rg9GB0YLRi9C8INC40LvQuCDRgdC+0YHRgtC+0Y/RgtGMINGC0L7Qu9GM0LrQviDQuNC3INC/0YDQvtCx0LXQu9C+0LJcIiwgXCJ0ZXh0XCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxufVxyXG5cclxuZm9ybS5zZW5kZXIub25pbnB1dCA9ICgpID0+IHtcclxuICAgIGxldCBlcnJvckVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3JfX3NlbmRlcicpO1xyXG4gICAgZXJyb3JFbGVtLmlubmVySFRNTCA9ICcnO1xyXG59XHJcblxyXG5mb3JtLnNlbmRlci5vbmZvY3VzID0gKGV2ZW50KSA9PiB7XHJcbiAgICBldmVudC50YXJnZXQucGxhY2Vob2xkZXIgPSAnJztcclxufVxyXG5cclxuZm9ybS5zZW5kZXIub25ibHVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09PSAnJykge1xyXG4gICAgICAgIGV2ZW50LnRhcmdldC5wbGFjZWhvbGRlciA9ICfQktCw0YjQtSDQuNC80Y8nO1xyXG4gICAgfVxyXG59XHJcblxyXG5mb3JtLnRleHQub25pbnB1dCA9IChldmVudCkgPT4ge1xyXG4gICAgbGV0IGVycm9yRWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcnJvcl9fdGV4dCcpO1xyXG4gICAgZXJyb3JFbGVtLmlubmVySFRNTCA9ICcnO1xyXG4gICAgZXZlbnQudGFyZ2V0LnBsYWNlaG9sZGVyID0gJyc7XHJcbn1cclxuXHJcbmZvcm0udGV4dC5vbmZvY3VzID0gKGV2ZW50KSA9PiB7XHJcbiAgICBldmVudC50YXJnZXQucGxhY2Vob2xkZXIgPSAnJztcclxufVxyXG5cclxuZm9ybS50ZXh0Lm9uYmx1ciA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSA9PT0gJycpIHtcclxuICAgICAgICBldmVudC50YXJnZXQucGxhY2Vob2xkZXIgPSAn0JLQsNGIINC60L7QvNC80LXQvdGC0LDRgNC40LkuLi4nO1xyXG4gICAgfVxyXG59XHJcblxyXG5mb3JtLmRhdGUub25rZXlkb3duID0gKCkgPT4ge1xyXG4gICAgaWYgKGNoZWNrRGF0ZUlucHV0KCkpIHtcclxuICAgICAgICBsZXQgZXJyb3JFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVycm9yX19kYXRlJyk7XHJcbiAgICAgICAgZXJyb3JFbGVtLmlubmVySFRNTCA9ICcnO1xyXG4gICAgfVxyXG59XHJcblxyXG5mb3JtLmRhdGUub25pbnB1dCA9ICgpID0+IHtcclxuICAgIGlmICghY2hlY2tEYXRlSW5wdXQoKSkge1xyXG4gICAgICAgIGxldCBlcnJvckVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3JfX2RhdGUnKTtcclxuICAgICAgICBlcnJvckVsZW0uaW5uZXJIVE1MID0gJyc7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZvcm0uZGF0ZS5vbmZvY3VzID0gKGV2ZW50KSA9PiB7XHJcbiAgICBldmVudC50YXJnZXQucGxhY2Vob2xkZXIgPSAnJztcclxufVxyXG5cclxuZm9ybS5kYXRlLm9uYmx1ciA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSA9PT0gJycgJiYgIWNoZWNrRGF0ZUlucHV0KCkpIHtcclxuICAgICAgICBldmVudC50YXJnZXQucGxhY2Vob2xkZXIgPSAn0LTQtC3QvNC8LdCz0LPQs9CzJztcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc3VibWl0T25FbnRlcihldmVudCkge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiAhZXZlbnQuc2hpZnRLZXkpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGxldCBmb3JtID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJyNjb21tZW50LWZvcm0nKTtcclxuICAgICAgICBmb3JtLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdzdWJtaXQnKSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRm9ybShldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGxldCBmb3JtID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgZm9ybS5zZW5kZXIudmFsdWUgPSBmb3JtLnNlbmRlci52YWx1ZS50cmltKCk7XHJcbiAgICBmb3JtLnRleHQudmFsdWUgPSBmb3JtLnRleHQudmFsdWUudHJpbSgpO1xyXG5cclxuICAgIGxldCBzZW5kZXJWYWxpZCA9IGZvcm0uc2VuZGVyLmNoZWNrVmFsaWRpdHkoKTtcclxuICAgIGxldCB0ZXh0VmFsaWQgPSBmb3JtLnRleHQuY2hlY2tWYWxpZGl0eSgpO1xyXG4gICAgbGV0IGRhdGVWYWxpZCA9IGZvcm0uZGF0ZS5jaGVja1ZhbGlkaXR5KCk7XHJcblxyXG4gICAgaWYgKCFzZW5kZXJWYWxpZCB8fCAhZGF0ZVZhbGlkIHx8ICF0ZXh0VmFsaWQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgZGF0ZTtcclxuICAgIGlmIChmb3JtLmRhdGUudmFsdWUgPT09ICcnKSB7XHJcbiAgICAgICAgZGF0ZSA9IGZvcm0uZGF0ZS5tYXg7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRhdGUgPSBmb3JtLmRhdGUudmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGZvcm1EYXRhID0ge1xyXG4gICAgICAgIHNlbmRlcjogZm9ybS5zZW5kZXIudmFsdWUsXHJcbiAgICAgICAgdGV4dDogZm9ybS50ZXh0LnZhbHVlLFxyXG4gICAgICAgIGRhdGVcclxuICAgIH1cclxuXHJcbiAgICBzdWJtaXRDb21tZW50KGZvcm1EYXRhKTtcclxufVxyXG5cclxuLy/Qv9GA0L7QstC10YDQutCwINC90LAg0L/QvtC00LTQtdGA0LbQutGDIGlucHV0IHR5cGU9J2RhdGUnXHJcbmZ1bmN0aW9uIGNoZWNrRGF0ZUlucHV0KCkge1xyXG4gICAgdmFyIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICdkYXRlJyk7XHJcblxyXG4gICAgdmFyIG5vdEFEYXRlVmFsdWUgPSAnbm90LWEtZGF0ZSc7XHJcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgbm90QURhdGVWYWx1ZSk7XHJcblxyXG4gICAgcmV0dXJuIChpbnB1dC52YWx1ZSAhPT0gbm90QURhdGVWYWx1ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpc3BsYXlFcnJvck1lc3NhZ2UobWVzc2FnZSwgZWxlbUNsYXNzKSB7XHJcbiAgICBsZXQgZXJyb3JFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmVycm9yX18ke2VsZW1DbGFzc31gKTtcclxuICAgIGVycm9yRWxlbS5pbm5lckhUTUwgPSBtZXNzYWdlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdWJtaXRDb21tZW50KHsgc2VuZGVyLCB0ZXh0LCBkYXRlIH0pIHtcclxuICAgIGNvbW1lbnRDb3VudCsrO1xyXG4gICAgY29tbWVudENvdW50ZXIudGV4dENvbnRlbnQgPSBjb21tZW50Q291bnQ7XHJcbiAgICBsZXQgY29tbWVudFNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWVudHNfX3NlY3Rpb24nKTtcclxuICAgIGxldCBjb21tZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgIGNvbW1lbnQuY2xhc3NOYW1lID0gJ2NvbW1lbnRzX19jb21tZW50JztcclxuICAgIGNvbW1lbnQuaWQgPSBgY29tbWVudC0ke2NvbW1lbnRJZCsrfWA7XHJcbiAgICBjb21tZW50LmRhdGFzZXQubGlrZSA9IFwiMFwiO1xyXG4gICAgbGV0IGNvbW1lbnRUZW1wbGF0ZSA9IGAgPGRpdiBjbGFzcz1cImNvbW1lbnRcIiB0YWJpbmRleD1cIi0xXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tbWVudF9faW5mb1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbW1lbnRfX3NlbmRlclwiPjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbW1lbnRfX2RhdGV0aW1lXCI+PC9kaXY+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tbWVudF9fdGV4dFwiPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9XCJjb21tZW50X19vcHRpb25zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tbWVudF9fbGlrZVwiPjxpbWcgc3JjPVwiLi9pbWcvbm90LWxpa2Uuc3ZnXCIgYWx0PVwi0JzQvdC1INC90YDQsNCy0LjRgtGB0Y9cIiB0aXRsZT1cItCc0L3QtSDQvdGA0LDQstC40YLRgdGPXCI+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tbWVudF9fZGVsZXRlXCI+PGltZyBzcmM9XCIuL2ltZy90cmFzaC5zdmdcIiBhbHQ9XCLQo9C00LDQu9C40YLRjCDQutC+0LzQvNC10L3RgtCw0YDQuNC5XCIgdGl0bGU9XCLQo9C00LDQu9C40YLRjCDQutC+0LzQvNC10L3RgtCw0YDQuNC5XCI+PC9kaXY+PC9kaXY+YFxyXG4gICAgY29tbWVudC5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyYmVnaW4nLCBjb21tZW50VGVtcGxhdGUpO1xyXG4gICAgY29tbWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWVudF9fc2VuZGVyJykudGV4dENvbnRlbnQgPSBzZW5kZXI7XHJcbiAgICBjb21tZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50X190ZXh0JykudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG4gICAgbGV0IGRhdGVPYmogPSBidWlsZERhdGVPYmooZGF0ZS5zcGxpdCgnLScpKTtcclxuICAgIGNvbW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1lbnRfX2RhdGV0aW1lJykudGV4dENvbnRlbnQgPSBkYXRlT2JqLmRhdGU7XHJcbiAgICBjb21tZW50LmRhdGFzZXQuZGF0ZSA9IGRhdGVPYmouZGF0ZVN0cjtcclxuICAgIGNvbW1lbnQuZGF0YXNldC50aW1lID0gZGF0ZU9iai50aW1lU3RyO1xyXG4gICAgY29tbWVudFNlY3Rpb24ucHJlcGVuZChjb21tZW50KTtcclxufVxyXG5cclxuZnVuY3Rpb24gYnVpbGREYXRlT2JqKFt5ZWFyLCBtb250aCwgZGF5XSkge1xyXG4gICAgbGV0IGRhdGUgPSBEYXRlLnBhcnNlKGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fWApO1xyXG4gICAgbGV0IGN1cnJlbnREYXRlID0gRGF0ZS5wYXJzZShmb3JtLmRhdGUubWF4KTtcclxuICAgIGxldCBwcmV2RGF0ZSA9IGN1cnJlbnREYXRlIC0gODY0MDAwMDA7XHJcblxyXG4gICAgbGV0IHRpbWVTdHIgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygpLnNsaWNlKDAsIDUpO1xyXG4gICAgbGV0IGRhdGVTdHIgPSBgJHtkYXl9LiR7bW9udGh9LiR7eWVhcn1gO1xyXG4gICAgbGV0IGRhdGVPYmogPSB7XHJcbiAgICAgICAgdGltZVN0cixcclxuICAgICAgICBkYXRlU3RyXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRhdGUgPT09IGN1cnJlbnREYXRlKSB7XHJcbiAgICAgICAgZGF0ZU9iai5kYXRlID0gYNGB0LXQs9C+0LTQvdGPLCAke3RpbWVTdHJ9YFxyXG4gICAgfSBlbHNlIGlmIChkYXRlID09PSBwcmV2RGF0ZSkge1xyXG4gICAgICAgIGRhdGVPYmouZGF0ZSA9IGDQstGH0LXRgNCwLCAke3RpbWVTdHJ9YFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkYXRlT2JqLmRhdGUgPSBgJHtkYXRlU3RyfSwgJHt0aW1lU3RyfWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGF0ZU9iajtcclxufVxyXG5cclxuY29tbWVudFNlY3Rpb24ub25jbGljayA9IChldmVudCkgPT4ge1xyXG4gICAgbGV0IHRhcmdldCA9IGV2ZW50LnRhcmdldDtcclxuICAgIGxldCBjb21tZW50ID0gdGFyZ2V0LmNsb3Nlc3QoJy5jb21tZW50c19fY29tbWVudCcpID8/IG51bGw7XHJcbiAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5jb21tZW50X19kZWxldGUnKSAmJiBjb21tZW50KSB7XHJcbiAgICAgICAgY29tbWVudC5yZW1vdmUoKTtcclxuICAgICAgICBjb21tZW50Q291bnQtLTtcclxuICAgICAgICBjb21tZW50Q291bnRlci50ZXh0Q29udGVudCA9IGNvbW1lbnRDb3VudDtcclxuICAgIH1cclxuICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmNvbW1lbnRfX2xpa2UnKSAmJiBjb21tZW50KSB7XHJcbiAgICAgICAgaWYgKGNvbW1lbnQuZGF0YXNldC5saWtlID09PSBcIjBcIikge1xyXG4gICAgICAgICAgICBjb21tZW50LmRhdGFzZXQubGlrZSA9IFwiMVwiO1xyXG4gICAgICAgICAgICB0YXJnZXQuc3JjID0gaW1nTGlrZVNyYztcclxuICAgICAgICAgICAgdGFyZ2V0LnRpdGxlID0gJ9Cc0L3QtSDQvdC1INC90YDQsNCy0LjRgtGB0Y8nO1xyXG4gICAgICAgICAgICB0YXJnZXQuYWx0ID0gJ9Cc0L3QtSDQvdC1INC90YDQsNCy0LjRgtGB0Y8nO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbW1lbnQuZGF0YXNldC5saWtlID0gXCIwXCI7XHJcbiAgICAgICAgICAgIHRhcmdldC5zcmMgPSBpbWdOb3RMaWtlU3JjO1xyXG4gICAgICAgICAgICB0YXJnZXQudGl0bGUgPSAn0JzQvdC1INC90YDQsNCy0LjRgtGB0Y8nO1xyXG4gICAgICAgICAgICB0YXJnZXQuYWx0ID0gJ9Cc0L3QtSDQvdGA0LDQstC40YLRgdGPJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImZvcm0iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29tbWVudFNlY3Rpb24iLCJxdWVyeVNlbGVjdG9yIiwibGV0IiwiY29tbWVudENvdW50IiwiY29tbWVudElkIiwiY29tbWVudENvdW50ZXIiLCJpbWdOb3RMaWtlU3JjIiwiaW1nTGlrZVNyYyIsInN1Ym1pdE9uRW50ZXIiLCJldmVudCIsImtleSIsInNoaWZ0S2V5IiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJjbG9zZXN0IiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwidmFsaWRhdGVGb3JtIiwic2VuZGVyVmFsaWQiLCJzZW5kZXIiLCJ2YWx1ZSIsInRyaW0iLCJ0ZXh0IiwiY2hlY2tWYWxpZGl0eSIsInRleHRWYWxpZCIsImRhdGVWYWxpZCIsImRhdGUiLCJtYXgiLCJzdWJtaXRDb21tZW50IiwiY2hlY2tEYXRlSW5wdXQiLCJpbnB1dCIsImNyZWF0ZUVsZW1lbnQiLCJub3RBRGF0ZVZhbHVlIiwic2V0QXR0cmlidXRlIiwiZGlzcGxheUVycm9yTWVzc2FnZSIsIm1lc3NhZ2UiLCJlbGVtQ2xhc3MiLCJpbm5lckhUTUwiLCJ0ZXh0Q29udGVudCIsImNvbW1lbnQiLCJkYXRlT2JqIiwiY2xhc3NOYW1lIiwiaWQiLCJkYXRhc2V0IiwibGlrZSIsImluc2VydEFkamFjZW50SFRNTCIsImJ1aWxkRGF0ZU9iaiIsInNwbGl0IiwiZGF0ZVN0ciIsInRpbWUiLCJ0aW1lU3RyIiwicHJlcGVuZCIsInllYXIiLCJtb250aCIsImRheSIsIkRhdGUiLCJwYXJzZSIsImN1cnJlbnREYXRlIiwicHJldkRhdGUiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJzbGljZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbmludmFsaWQiLCJsZW5ndGgiLCJ0ZXN0IiwicmVnZXgiLCJkYXRlRGF5IiwiZGF0ZU1vbnRoIiwiZGF0ZVllYXIiLCJnZXRGdWxsWWVhciIsImdldERhdGUiLCJvbmlucHV0Iiwib25mb2N1cyIsInBsYWNlaG9sZGVyIiwib25ibHVyIiwib25rZXlkb3duIiwib25jbGljayIsInJlbW92ZSIsInNyYyIsInRpdGxlIiwiYWx0Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxLQUFPQyxTQUFTQyxlQUFlLGNBQWMsRUFFN0NDLGVBQWlCRixTQUFTRyxjQUFjLG9CQUFvQixFQUVsRUMsSUFBSUMsYUFBZSxFQUNmQyxVQUFZLEVBRVpDLGVBQWlCUCxTQUFTQyxlQUFlLE9BQU8sRUFFaERPLGNBQWdCLHFCQUNoQkMsV0FBYSxpQkFpSGpCLFNBQVNDLGNBQWNDLEdBQ0QsVUFBZEEsRUFBTUMsS0FBb0JELEVBQU1FLFdBQ2hDRixFQUFNRyxlQUFlLEVBQ1ZILEVBQU1JLE9BQU9DLFFBQVEsZUFBZSxFQUMxQ0MsY0FBYyxJQUFJQyxNQUFNLFFBQVEsQ0FBQyxFQUU5QyxDQUVBLFNBQVNDLGFBQWFSLEdBQ2xCQSxFQUFNRyxlQUFlLEVBQ3JCVixJQUFJTCxFQUFPWSxFQUFNSSxPQUliSyxHQUhKckIsRUFBS3NCLE9BQU9DLE1BQVF2QixFQUFLc0IsT0FBT0MsTUFBTUMsS0FBSyxFQUMzQ3hCLEVBQUt5QixLQUFLRixNQUFRdkIsRUFBS3lCLEtBQUtGLE1BQU1DLEtBQUssRUFFckJ4QixFQUFLc0IsT0FBT0ksY0FBYyxHQUN4Q0MsRUFBWTNCLEVBQUt5QixLQUFLQyxjQUFjLEVBQ3BDRSxFQUFZNUIsRUFBSzZCLEtBQUtILGNBQWMsRUFFeEMsR0FBS0wsR0FBZ0JPLEdBQWNELEVBQW5DLENBR0F0QixJQUFJd0IsRUFFQUEsRUFEb0IsS0FBcEI3QixFQUFLNkIsS0FBS04sTUFDSHZCLEVBQUs2QixLQUFLQyxJQUVWOUIsRUFBSzZCLEtBQUtOLE1BU3JCUSxjQU5lLENBQ1hULE9BQVF0QixFQUFLc0IsT0FBT0MsTUFDcEJF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
