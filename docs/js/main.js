const form=document.getElementById("comment-form"),commentSection=document.querySelector(".comments__section");let commentCount=0,commentId=0,commentCounter=document.getElementById("count"),imgNotLikeSrc="./img/not-like.svg",imgLikeSrc="./img/like.svg";function submitOnEnter(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),e.target.closest("#comment-form").dispatchEvent(new Event("submit")))}function validateForm(t){t.preventDefault();var t=t.target,e=(t.sender.value=t.sender.value.trim(),t.text.value=t.text.value.trim(),t.sender.checkValidity()),r=t.text.checkValidity(),n=t.date.checkValidity();if(e&&n&&r){let e;e=""===t.date.value?t.date.max:t.date.value,submitComment({sender:t.sender.value,text:t.text.value,date:e})}}function checkDateInput(){var e=document.createElement("input"),t=(e.setAttribute("type","date"),"not-a-date");return e.setAttribute("value",t),e.value!==t}function displayErrorMessage(e,t){document.querySelector(".error__"+t).innerHTML=e}function submitComment({sender:e,text:t,date:r}){commentCount++,commentCounter.textContent=commentCount;var n=document.querySelector(".comments__section"),a=document.createElement("li"),e=(a.className="comments__comment",a.id="comment-"+commentId++,a.dataset.like="0",a.insertAdjacentHTML("afterbegin",` <div class="comment" tabindex="-1">
                            <div class="comment__info">
                            <div class="comment__sender"></div>
                            <div class="comment__datetime"></div></div>
                            <div class="comment__text"></div></div><div class="comment__options">
                            <div class="comment__like"><img src="./img/not-like.svg" alt="Мне нравится" title="Мне нравится"></div>
                            <div class="comment__delete"><img src="./img/trash.svg" alt="Удалить комментарий" title="Удалить комментарий"></div></div>`),a.querySelector(".comment__sender").textContent=e,a.querySelector(".comment__text").textContent=t,buildDateObj(r.split("-")));a.querySelector(".comment__datetime").textContent=e.date,a.dataset.date=e.dateStr,a.dataset.time=e.timeStr,n.prepend(a)}function buildDateObj([e,t,r]){var n=Date.parse(e+`-${t}-`+r),a=Date.parse(form.date.max),o=a-864e5,m=(new Date).toLocaleTimeString().slice(0,5),r=r+`.${t}.`+e,t={timeStr:m,dateStr:r};return t.date=n===a?"сегодня, "+m:n===o?"вчера, "+m:r+", "+m,t}form.date.max=(new Date).toLocaleDateString("fr-ca"),form.addEventListener("keydown",submitOnEnter),form.addEventListener("submit",validateForm),form.sender.oninvalid=e=>{e=e.target.value;0===e.length?displayErrorMessage("Имя не может быть пустым или<br> состоять только из пробелов","sender"):e.length<6||30<e.length?displayErrorMessage("Имя должно иметь длину от 6 до 30 символов","sender"):/^[a-zA-Zа-яА-Я0-9\-_ ]{6,30}$/g.test(e)||displayErrorMessage("Имя может содержать:<br>- русский и латинский алфавит<br>- цифры (0 - 9)<br>- дефис и нижнее подчеркивание","sender")},form.date.oninvalid=e=>{if(!checkDateInput()){var t=new Date;if(dateStr=e.target.value.trim(),!(regex=/^(0[1-9]|[12][0-9]|3[01])[-](0[1-9]|1[012])[-](19|20)\d\d$/g).test(dateStr))return void displayErrorMessage("Дата должна быть в формате:<br>дд-мм-гггг","date");var[e,r,n]=dateStr.split("-"),e=+e;if(r-=1,(n=+n)<1970||n>t.getFullYear())return void displayErrorMessage("Год должен быть между 1970 и "+t.getFullYear(),"date");if(new Date(n,1+r,0).getDate()<e)return void displayErrorMessage("Введена некорректная дата","date")}displayErrorMessage("Введена некорректная дата","date")},form.text.oninvalid=e=>{0===e.target.value.length&&displayErrorMessage("Комментарий не может быть пустым или состоять только из пробелов","text")},form.sender.oninput=()=>{document.querySelector(".error__sender").innerHTML=""},form.sender.onfocus=e=>{e.target.placeholder=""},form.sender.onblur=e=>{""===e.target.value&&(e.target.placeholder="Ваше имя")},form.text.oninput=e=>{document.querySelector(".error__text").innerHTML="",e.target.placeholder=""},form.text.onfocus=e=>{e.target.placeholder=""},form.text.onblur=e=>{""===e.target.value&&(e.target.placeholder="Ваш комментарий...")},form.date.onkeydown=()=>{checkDateInput()&&(document.querySelector(".error__date").innerHTML="")},form.date.oninput=()=>{checkDateInput()||(document.querySelector(".error__date").innerHTML="")},form.date.onchange=()=>{document.querySelector(".error__date").innerHTML=""},form.date.onfocus=e=>{e.target.placeholder=""},form.date.onblur=e=>{""!==e.target.value||checkDateInput()||(e.target.placeholder="дд-мм-гггг")},commentSection.onclick=e=>{var e=e.target,t=e.closest(".comments__comment")??null;e.closest(".comment__delete")&&t&&(t.remove(),commentCount--,commentCounter.textContent=commentCount),e.closest(".comment__like")&&t&&("0"===t.dataset.like?(t.dataset.like="1",e.src=imgLikeSrc,e.title="Мне не нравится",e.alt="Мне не нравится"):(t.dataset.like="0",e.src=imgNotLikeSrc,e.title="Мне нравится",e.alt="Мне нравится"))};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibWFpbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnQtZm9ybScpO1xyXG5cclxuY29uc3QgY29tbWVudFNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWVudHNfX3NlY3Rpb24nKTtcclxuXHJcbmxldCBjb21tZW50Q291bnQgPSAwO1xyXG5sZXQgY29tbWVudElkID0gMDtcclxuXHJcbmxldCBjb21tZW50Q291bnRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudCcpO1xyXG5cclxubGV0IGltZ05vdExpa2VTcmMgPSAnLi9pbWcvbm90LWxpa2Uuc3ZnJztcclxubGV0IGltZ0xpa2VTcmMgPSAnLi9pbWcvbGlrZS5zdmcnO1xyXG5cclxuZm9ybS5kYXRlLm1heCA9IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCdmci1jYScpO1xyXG5cclxuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgc3VibWl0T25FbnRlcik7XHJcbmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdmFsaWRhdGVGb3JtKTtcclxuXHJcbmZvcm0uc2VuZGVyLm9uaW52YWxpZCA9IChldmVudCkgPT4ge1xyXG4gICAgbGV0IHNlbmRlciA9IGV2ZW50LnRhcmdldC52YWx1ZTtcclxuICAgIGlmIChzZW5kZXIubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgZGlzcGxheUVycm9yTWVzc2FnZShcItCY0LzRjyDQvdC1INC80L7QttC10YIg0LHRi9GC0Ywg0L/Rg9GB0YLRi9C8INC40LvQuDxicj4g0YHQvtGB0YLQvtGP0YLRjCDRgtC+0LvRjNC60L4g0LjQtyDQv9GA0L7QsdC10LvQvtCyXCIsIFwic2VuZGVyXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChzZW5kZXIubGVuZ3RoIDwgNiB8fCBzZW5kZXIubGVuZ3RoID4gMzApIHtcclxuICAgICAgICBkaXNwbGF5RXJyb3JNZXNzYWdlKFwi0JjQvNGPINC00L7Qu9C20L3QviDQuNC80LXRgtGMINC00LvQuNC90YMg0L7RgiA2INC00L4gMzAg0YHQuNC80LLQvtC70L7QslwiLCBcInNlbmRlclwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgcmVnZXggPSAvXlthLXpBLVrQsC3Rj9CQLdCvMC05XFwtXyBdezYsMzB9JC9nO1xyXG4gICAgaWYgKCFyZWdleC50ZXN0KHNlbmRlcikpIHtcclxuICAgICAgICBkaXNwbGF5RXJyb3JNZXNzYWdlKFwi0JjQvNGPINC80L7QttC10YIg0YHQvtC00LXRgNC20LDRgtGMOjxicj4tINGA0YPRgdGB0LrQuNC5INC4INC70LDRgtC40L3RgdC60LjQuSDQsNC70YTQsNCy0LjRgjxicj4tINGG0LjRhNGA0YsgKDAgLSA5KTxicj4tINC00LXRhNC40YEg0Lgg0L3QuNC20L3QtdC1INC/0L7QtNGH0LXRgNC60LjQstCw0L3QuNC1XCIsIFwic2VuZGVyXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxufTtcclxuXHJcbmZvcm0uZGF0ZS5vbmludmFsaWQgPSAoZXZlbnQpID0+IHtcclxuICAgIGlmICghY2hlY2tEYXRlSW5wdXQoKSkge1xyXG4gICAgICAgIGxldCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgZGF0ZVN0ciA9IGV2ZW50LnRhcmdldC52YWx1ZS50cmltKCk7XHJcbiAgICAgICAgcmVnZXggPSAvXigwWzEtOV18WzEyXVswLTldfDNbMDFdKVstXSgwWzEtOV18MVswMTJdKVstXSgxOXwyMClcXGRcXGQkL2c7XHJcbiAgICAgICAgaWYgKCFyZWdleC50ZXN0KGRhdGVTdHIpKSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlFcnJvck1lc3NhZ2UoXCLQlNCw0YLQsCDQtNC+0LvQttC90LAg0LHRi9GC0Ywg0LIg0YTQvtGA0LzQsNGC0LU6PGJyPtC00LQt0LzQvC3Qs9Cz0LPQs1wiLCBcImRhdGVcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IFtkYXRlRGF5LCBkYXRlTW9udGgsIGRhdGVZZWFyXSA9IGRhdGVTdHIuc3BsaXQoXCItXCIpO1xyXG4gICAgICAgIGRhdGVEYXkgPSArZGF0ZURheTtcclxuICAgICAgICBkYXRlTW9udGggPSBkYXRlTW9udGggLSAxO1xyXG4gICAgICAgIGRhdGVZZWFyID0gK2RhdGVZZWFyO1xyXG4gICAgICAgIGlmIChkYXRlWWVhciA8IDE5NzAgfHwgZGF0ZVllYXIgPiBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpKSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlFcnJvck1lc3NhZ2UoYNCT0L7QtCDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LzQtdC20LTRgyAxOTcwINC4ICR7Y3VycmVudERhdGUuZ2V0RnVsbFllYXIoKX1gLCBcImRhdGVcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGRhdGVMYXN0RGF5ID0gbmV3IERhdGUoZGF0ZVllYXIsIGRhdGVNb250aCArIDEsIDApLmdldERhdGUoKTtcclxuICAgICAgICBpZiAoZGF0ZURheSA+IGRhdGVMYXN0RGF5KSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlFcnJvck1lc3NhZ2UoJ9CS0LLQtdC00LXQvdCwINC90LXQutC+0YDRgNC10LrRgtC90LDRjyDQtNCw0YLQsCcsIFwiZGF0ZVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGRpc3BsYXlFcnJvck1lc3NhZ2UoJ9CS0LLQtdC00LXQvdCwINC90LXQutC+0YDRgNC10LrRgtC90LDRjyDQtNCw0YLQsCcsIFwiZGF0ZVwiKTtcclxufVxyXG5cclxuZm9ybS50ZXh0Lm9uaW52YWxpZCA9IChldmVudCkgPT4ge1xyXG4gICAgbGV0IHRleHQgPSBldmVudC50YXJnZXQudmFsdWU7XHJcbiAgICBpZiAodGV4dC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBkaXNwbGF5RXJyb3JNZXNzYWdlKFwi0JrQvtC80LzQtdC90YLQsNGA0LjQuSDQvdC1INC80L7QttC10YIg0LHRi9GC0Ywg0L/Rg9GB0YLRi9C8INC40LvQuCDRgdC+0YHRgtC+0Y/RgtGMINGC0L7Qu9GM0LrQviDQuNC3INC/0YDQvtCx0LXQu9C+0LJcIiwgXCJ0ZXh0XCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxufVxyXG5cclxuZm9ybS5zZW5kZXIub25pbnB1dCA9ICgpID0+IHtcclxuICAgIGxldCBlcnJvckVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3JfX3NlbmRlcicpO1xyXG4gICAgZXJyb3JFbGVtLmlubmVySFRNTCA9ICcnO1xyXG59XHJcblxyXG5mb3JtLnNlbmRlci5vbmZvY3VzID0gKGV2ZW50KSA9PiB7XHJcbiAgICBldmVudC50YXJnZXQucGxhY2Vob2xkZXIgPSAnJztcclxufVxyXG5cclxuZm9ybS5zZW5kZXIub25ibHVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09PSAnJykge1xyXG4gICAgICAgIGV2ZW50LnRhcmdldC5wbGFjZWhvbGRlciA9ICfQktCw0YjQtSDQuNC80Y8nO1xyXG4gICAgfVxyXG59XHJcblxyXG5mb3JtLnRleHQub25pbnB1dCA9IChldmVudCkgPT4ge1xyXG4gICAgbGV0IGVycm9yRWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lcnJvcl9fdGV4dCcpO1xyXG4gICAgZXJyb3JFbGVtLmlubmVySFRNTCA9ICcnO1xyXG4gICAgZXZlbnQudGFyZ2V0LnBsYWNlaG9sZGVyID0gJyc7XHJcbn1cclxuXHJcbmZvcm0udGV4dC5vbmZvY3VzID0gKGV2ZW50KSA9PiB7XHJcbiAgICBldmVudC50YXJnZXQucGxhY2Vob2xkZXIgPSAnJztcclxufVxyXG5cclxuZm9ybS50ZXh0Lm9uYmx1ciA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSA9PT0gJycpIHtcclxuICAgICAgICBldmVudC50YXJnZXQucGxhY2Vob2xkZXIgPSAn0JLQsNGIINC60L7QvNC80LXQvdGC0LDRgNC40LkuLi4nO1xyXG4gICAgfVxyXG59XHJcblxyXG5mb3JtLmRhdGUub25rZXlkb3duID0gKCkgPT4ge1xyXG4gICAgaWYgKGNoZWNrRGF0ZUlucHV0KCkpIHtcclxuICAgICAgICBsZXQgZXJyb3JFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVycm9yX19kYXRlJyk7XHJcbiAgICAgICAgZXJyb3JFbGVtLmlubmVySFRNTCA9ICcnO1xyXG4gICAgfVxyXG59XHJcblxyXG5mb3JtLmRhdGUub25pbnB1dCA9ICgpID0+IHtcclxuICAgIGlmICghY2hlY2tEYXRlSW5wdXQoKSkge1xyXG4gICAgICAgIGxldCBlcnJvckVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3JfX2RhdGUnKTtcclxuICAgICAgICBlcnJvckVsZW0uaW5uZXJIVE1MID0gJyc7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZvcm0uZGF0ZS5vbmNoYW5nZSA9ICgpID0+IHtcclxuICAgIGxldCBlcnJvckVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3JfX2RhdGUnKTtcclxuICAgIGVycm9yRWxlbS5pbm5lckhUTUwgPSAnJztcclxufVxyXG5cclxuZm9ybS5kYXRlLm9uZm9jdXMgPSAoZXZlbnQpID0+IHtcclxuICAgIGV2ZW50LnRhcmdldC5wbGFjZWhvbGRlciA9ICcnO1xyXG59XHJcblxyXG5mb3JtLmRhdGUub25ibHVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09PSAnJyAmJiAhY2hlY2tEYXRlSW5wdXQoKSkge1xyXG4gICAgICAgIGV2ZW50LnRhcmdldC5wbGFjZWhvbGRlciA9ICfQtNC0LdC80Lwt0LPQs9Cz0LMnO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzdWJtaXRPbkVudGVyKGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInICYmICFldmVudC5zaGlmdEtleSkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgbGV0IGZvcm0gPSBldmVudC50YXJnZXQuY2xvc2VzdCgnI2NvbW1lbnQtZm9ybScpO1xyXG4gICAgICAgIGZvcm0uZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3N1Ym1pdCcpKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRhdGVGb3JtKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgbGV0IGZvcm0gPSBldmVudC50YXJnZXQ7XHJcbiAgICBmb3JtLnNlbmRlci52YWx1ZSA9IGZvcm0uc2VuZGVyLnZhbHVlLnRyaW0oKTtcclxuICAgIGZvcm0udGV4dC52YWx1ZSA9IGZvcm0udGV4dC52YWx1ZS50cmltKCk7XHJcblxyXG4gICAgbGV0IHNlbmRlclZhbGlkID0gZm9ybS5zZW5kZXIuY2hlY2tWYWxpZGl0eSgpO1xyXG4gICAgbGV0IHRleHRWYWxpZCA9IGZvcm0udGV4dC5jaGVja1ZhbGlkaXR5KCk7XHJcbiAgICBsZXQgZGF0ZVZhbGlkID0gZm9ybS5kYXRlLmNoZWNrVmFsaWRpdHkoKTtcclxuXHJcbiAgICBpZiAoIXNlbmRlclZhbGlkIHx8ICFkYXRlVmFsaWQgfHwgIXRleHRWYWxpZCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGxldCBkYXRlO1xyXG4gICAgaWYgKGZvcm0uZGF0ZS52YWx1ZSA9PT0gJycpIHtcclxuICAgICAgICBkYXRlID0gZm9ybS5kYXRlLm1heDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGF0ZSA9IGZvcm0uZGF0ZS52YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZm9ybURhdGEgPSB7XHJcbiAgICAgICAgc2VuZGVyOiBmb3JtLnNlbmRlci52YWx1ZSxcclxuICAgICAgICB0ZXh0OiBmb3JtLnRleHQudmFsdWUsXHJcbiAgICAgICAgZGF0ZVxyXG4gICAgfVxyXG5cclxuICAgIHN1Ym1pdENvbW1lbnQoZm9ybURhdGEpO1xyXG59XHJcblxyXG4vL9C/0YDQvtCy0LXRgNC60LAg0L3QsCDQv9C+0LTQtNC10YDQttC60YMgaW5wdXQgdHlwZT0nZGF0ZSdcclxuZnVuY3Rpb24gY2hlY2tEYXRlSW5wdXQoKSB7XHJcbiAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2RhdGUnKTtcclxuXHJcbiAgICB2YXIgbm90QURhdGVWYWx1ZSA9ICdub3QtYS1kYXRlJztcclxuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgndmFsdWUnLCBub3RBRGF0ZVZhbHVlKTtcclxuXHJcbiAgICByZXR1cm4gKGlucHV0LnZhbHVlICE9PSBub3RBRGF0ZVZhbHVlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGlzcGxheUVycm9yTWVzc2FnZShtZXNzYWdlLCBlbGVtQ2xhc3MpIHtcclxuICAgIGxldCBlcnJvckVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuZXJyb3JfXyR7ZWxlbUNsYXNzfWApO1xyXG4gICAgZXJyb3JFbGVtLmlubmVySFRNTCA9IG1lc3NhZ2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN1Ym1pdENvbW1lbnQoeyBzZW5kZXIsIHRleHQsIGRhdGUgfSkge1xyXG4gICAgY29tbWVudENvdW50Kys7XHJcbiAgICBjb21tZW50Q291bnRlci50ZXh0Q29udGVudCA9IGNvbW1lbnRDb3VudDtcclxuICAgIGxldCBjb21tZW50U2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50c19fc2VjdGlvbicpO1xyXG4gICAgbGV0IGNvbW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgY29tbWVudC5jbGFzc05hbWUgPSAnY29tbWVudHNfX2NvbW1lbnQnO1xyXG4gICAgY29tbWVudC5pZCA9IGBjb21tZW50LSR7Y29tbWVudElkKyt9YDtcclxuICAgIGNvbW1lbnQuZGF0YXNldC5saWtlID0gXCIwXCI7XHJcbiAgICBsZXQgY29tbWVudFRlbXBsYXRlID0gYCA8ZGl2IGNsYXNzPVwiY29tbWVudFwiIHRhYmluZGV4PVwiLTFcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb21tZW50X19pbmZvXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tbWVudF9fc2VuZGVyXCI+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tbWVudF9fZGF0ZXRpbWVcIj48L2Rpdj48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb21tZW50X190ZXh0XCI+PC9kaXY+PC9kaXY+PGRpdiBjbGFzcz1cImNvbW1lbnRfX29wdGlvbnNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb21tZW50X19saWtlXCI+PGltZyBzcmM9XCIuL2ltZy9ub3QtbGlrZS5zdmdcIiBhbHQ9XCLQnNC90LUg0L3RgNCw0LLQuNGC0YHRj1wiIHRpdGxlPVwi0JzQvdC1INC90YDQsNCy0LjRgtGB0Y9cIj48L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb21tZW50X19kZWxldGVcIj48aW1nIHNyYz1cIi4vaW1nL3RyYXNoLnN2Z1wiIGFsdD1cItCj0LTQsNC70LjRgtGMINC60L7QvNC80LXQvdGC0LDRgNC40LlcIiB0aXRsZT1cItCj0LTQsNC70LjRgtGMINC60L7QvNC80LXQvdGC0LDRgNC40LlcIj48L2Rpdj48L2Rpdj5gXHJcbiAgICBjb21tZW50Lmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIGNvbW1lbnRUZW1wbGF0ZSk7XHJcbiAgICBjb21tZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50X19zZW5kZXInKS50ZXh0Q29udGVudCA9IHNlbmRlcjtcclxuICAgIGNvbW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1lbnRfX3RleHQnKS50ZXh0Q29udGVudCA9IHRleHQ7XHJcbiAgICBsZXQgZGF0ZU9iaiA9IGJ1aWxkRGF0ZU9iaihkYXRlLnNwbGl0KCctJykpO1xyXG4gICAgY29tbWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWVudF9fZGF0ZXRpbWUnKS50ZXh0Q29udGVudCA9IGRhdGVPYmouZGF0ZTtcclxuICAgIGNvbW1lbnQuZGF0YXNldC5kYXRlID0gZGF0ZU9iai5kYXRlU3RyO1xyXG4gICAgY29tbWVudC5kYXRhc2V0LnRpbWUgPSBkYXRlT2JqLnRpbWVTdHI7XHJcbiAgICBjb21tZW50U2VjdGlvbi5wcmVwZW5kKGNvbW1lbnQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZERhdGVPYmooW3llYXIsIG1vbnRoLCBkYXldKSB7XHJcbiAgICBsZXQgZGF0ZSA9IERhdGUucGFyc2UoYCR7eWVhcn0tJHttb250aH0tJHtkYXl9YCk7XHJcbiAgICBsZXQgY3VycmVudERhdGUgPSBEYXRlLnBhcnNlKGZvcm0uZGF0ZS5tYXgpO1xyXG4gICAgbGV0IHByZXZEYXRlID0gY3VycmVudERhdGUgLSA4NjQwMDAwMDtcclxuXHJcbiAgICBsZXQgdGltZVN0ciA9IG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCkuc2xpY2UoMCwgNSk7XHJcbiAgICBsZXQgZGF0ZVN0ciA9IGAke2RheX0uJHttb250aH0uJHt5ZWFyfWA7XHJcbiAgICBsZXQgZGF0ZU9iaiA9IHtcclxuICAgICAgICB0aW1lU3RyLFxyXG4gICAgICAgIGRhdGVTdHJcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZGF0ZSA9PT0gY3VycmVudERhdGUpIHtcclxuICAgICAgICBkYXRlT2JqLmRhdGUgPSBg0YHQtdCz0L7QtNC90Y8sICR7dGltZVN0cn1gXHJcbiAgICB9IGVsc2UgaWYgKGRhdGUgPT09IHByZXZEYXRlKSB7XHJcbiAgICAgICAgZGF0ZU9iai5kYXRlID0gYNCy0YfQtdGA0LAsICR7dGltZVN0cn1gXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRhdGVPYmouZGF0ZSA9IGAke2RhdGVTdHJ9LCAke3RpbWVTdHJ9YDtcclxuICAgIH1cclxuICAgIHJldHVybiBkYXRlT2JqO1xyXG59XHJcblxyXG5jb21tZW50U2VjdGlvbi5vbmNsaWNrID0gKGV2ZW50KSA9PiB7XHJcbiAgICBsZXQgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgbGV0IGNvbW1lbnQgPSB0YXJnZXQuY2xvc2VzdCgnLmNvbW1lbnRzX19jb21tZW50JykgPz8gbnVsbDtcclxuICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmNvbW1lbnRfX2RlbGV0ZScpICYmIGNvbW1lbnQpIHtcclxuICAgICAgICBjb21tZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIGNvbW1lbnRDb3VudC0tO1xyXG4gICAgICAgIGNvbW1lbnRDb3VudGVyLnRleHRDb250ZW50ID0gY29tbWVudENvdW50O1xyXG4gICAgfVxyXG4gICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuY29tbWVudF9fbGlrZScpICYmIGNvbW1lbnQpIHtcclxuICAgICAgICBpZiAoY29tbWVudC5kYXRhc2V0Lmxpa2UgPT09IFwiMFwiKSB7XHJcbiAgICAgICAgICAgIGNvbW1lbnQuZGF0YXNldC5saWtlID0gXCIxXCI7XHJcbiAgICAgICAgICAgIHRhcmdldC5zcmMgPSBpbWdMaWtlU3JjO1xyXG4gICAgICAgICAgICB0YXJnZXQudGl0bGUgPSAn0JzQvdC1INC90LUg0L3RgNCw0LLQuNGC0YHRjyc7XHJcbiAgICAgICAgICAgIHRhcmdldC5hbHQgPSAn0JzQvdC1INC90LUg0L3RgNCw0LLQuNGC0YHRjyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29tbWVudC5kYXRhc2V0Lmxpa2UgPSBcIjBcIjtcclxuICAgICAgICAgICAgdGFyZ2V0LnNyYyA9IGltZ05vdExpa2VTcmM7XHJcbiAgICAgICAgICAgIHRhcmdldC50aXRsZSA9ICfQnNC90LUg0L3RgNCw0LLQuNGC0YHRjyc7XHJcbiAgICAgICAgICAgIHRhcmdldC5hbHQgPSAn0JzQvdC1INC90YDQsNCy0LjRgtGB0Y8nO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZm9ybSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb21tZW50U2VjdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJsZXQiLCJjb21tZW50Q291bnQiLCJjb21tZW50SWQiLCJjb21tZW50Q291bnRlciIsImltZ05vdExpa2VTcmMiLCJpbWdMaWtlU3JjIiwic3VibWl0T25FbnRlciIsImV2ZW50Iiwia2V5Iiwic2hpZnRLZXkiLCJwcmV2ZW50RGVmYXVsdCIsInRhcmdldCIsImNsb3Nlc3QiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJ2YWxpZGF0ZUZvcm0iLCJzZW5kZXJWYWxpZCIsInNlbmRlciIsInZhbHVlIiwidHJpbSIsInRleHQiLCJjaGVja1ZhbGlkaXR5IiwidGV4dFZhbGlkIiwiZGF0ZVZhbGlkIiwiZGF0ZSIsIm1heCIsInN1Ym1pdENvbW1lbnQiLCJjaGVja0RhdGVJbnB1dCIsImlucHV0IiwiY3JlYXRlRWxlbWVudCIsIm5vdEFEYXRlVmFsdWUiLCJzZXRBdHRyaWJ1dGUiLCJkaXNwbGF5RXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsImVsZW1DbGFzcyIsImlubmVySFRNTCIsInRleHRDb250ZW50IiwiY29tbWVudCIsImRhdGVPYmoiLCJjbGFzc05hbWUiLCJpZCIsImRhdGFzZXQiLCJsaWtlIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwiYnVpbGREYXRlT2JqIiwic3BsaXQiLCJkYXRlU3RyIiwidGltZSIsInRpbWVTdHIiLCJwcmVwZW5kIiwieWVhciIsIm1vbnRoIiwiZGF5IiwiRGF0ZSIsInBhcnNlIiwiY3VycmVudERhdGUiLCJwcmV2RGF0ZSIsInRvTG9jYWxlVGltZVN0cmluZyIsInNsaWNlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uaW52YWxpZCIsImxlbmd0aCIsInRlc3QiLCJyZWdleCIsImRhdGVEYXkiLCJkYXRlTW9udGgiLCJkYXRlWWVhciIsImdldEZ1bGxZZWFyIiwiZ2V0RGF0ZSIsIm9uaW5wdXQiLCJvbmZvY3VzIiwicGxhY2Vob2xkZXIiLCJvbmJsdXIiLCJvbmtleWRvd24iLCJvbmNoYW5nZSIsIm9uY2xpY2siLCJyZW1vdmUiLCJzcmMiLCJ0aXRsZSIsImFsdCJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsS0FBT0MsU0FBU0MsZUFBZSxjQUFjLEVBRTdDQyxlQUFpQkYsU0FBU0csY0FBYyxvQkFBb0IsRUFFbEVDLElBQUlDLGFBQWUsRUFDZkMsVUFBWSxFQUVaQyxlQUFpQlAsU0FBU0MsZUFBZSxPQUFPLEVBRWhETyxjQUFnQixxQkFDaEJDLFdBQWEsaUJBc0hqQixTQUFTQyxjQUFjQyxHQUNELFVBQWRBLEVBQU1DLEtBQW9CRCxFQUFNRSxXQUNoQ0YsRUFBTUcsZUFBZSxFQUNWSCxFQUFNSSxPQUFPQyxRQUFRLGVBQWUsRUFDMUNDLGNBQWMsSUFBSUMsTUFBTSxRQUFRLENBQUMsRUFFOUMsQ0FFQSxTQUFTQyxhQUFhUixHQUNsQkEsRUFBTUcsZUFBZSxFQUNyQlYsSUFBSUwsRUFBT1ksRUFBTUksT0FJYkssR0FISnJCLEVBQUtzQixPQUFPQyxNQUFRdkIsRUFBS3NCLE9BQU9DLE1BQU1DLEtBQUssRUFDM0N4QixFQUFLeUIsS0FBS0YsTUFBUXZCLEVBQUt5QixLQUFLRixNQUFNQyxLQUFLLEVBRXJCeEIsRUFBS3NCLE9BQU9JLGNBQWMsR0FDeENDLEVBQVkzQixFQUFLeUIsS0FBS0MsY0FBYyxFQUNwQ0UsRUFBWTVCLEVBQUs2QixLQUFLSCxjQUFjLEVBRXhDLEdBQUtMLEdB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
